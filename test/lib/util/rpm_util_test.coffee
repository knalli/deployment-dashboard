util = require 'util'

RpmUtil = require '../../../src/lib/util/rpm_util'

module.exports =

  testSingleLine: (test) ->
    test.expect 4
    result = RpmUtil.resolveDataByLine 'project-backend.noarch            1.0.0-155              @/project-backend-1.0.0-155.noarch'
    test.ok result, 'Extract data object should be available.'
    test.equal result.name, 'project-backend', 'The name of the package is not correct.'
    test.equal result.version, '1.0.0-155', 'The version of the package is not correct.'
    test.equal result.arch, 'noarch', 'The architectur of the package is not correct.'
    test.done()

  testMultiLines: (test) ->
    test.expect 3
    results = RpmUtil.resolveDataByLines '                                 3.2.1-11.8.amzn1       @project               \napache-commons-daemon.x86_64     1.0.7-1.5.amzn1        @project               \napache-commons-dbcp.noarch       1.4-7.7.amzn1          @project               \napache-commons-logging.noarch    1.1.1-16.8.amzn1       @project               \napache-commons-pool.noarch       1.5.6-1.7.amzn1        @project               \napr.x86_64                       1.4.6-1.10.amzn1       @project               \napr-util.x86_64                  1.4.1-4.14.amzn1       @project               \necj.x86_64                       1:4.2.1-4.15.amzn1     @project               \nerlang.x86_64                    R14B-04.2.7.amzn1      @project               \nerlang-appmon.x86_64             R14B-04.2.7.amzn1      @project               \nerlang-asn1.x86_64               R14B-04.2.7.amzn1      @project               \nerlang-common_test.x86_64        R14B-04.2.7.amzn1      @project               \nerlang-compiler.x86_64           R14B-04.2.7.amzn1      @project               \nerlang-cosEvent.x86_64           R14B-04.2.7.amzn1      @project               \nerlang-cosEventDomain.x86_64     R14B-04.2.7.amzn1      @project               \nerlang-cosFileTransfer.x86_64    R14B-04.2.7.amzn1      @project               \nerlang-cosNotification.x86_64    R14B-04.2.7.amzn1      @project               \nerlang-cosProperty.x86_64        R14B-04.2.7.amzn1      @project               \nerlang-cosTime.x86_64            R14B-04.2.7.amzn1      @project               \nerlang-cosTransactions.x86_64    R14B-04.2.7.amzn1      @project               \nerlang-crypto.x86_64             R14B-04.2.7.amzn1      @project               \nerlang-debugger.x86_64           R14B-04.2.7.amzn1      @project               \nerlang-dialyzer.x86_64           R14B-04.2.7.amzn1      @project               \nerlang-diameter.x86_64           R14B-04.2.7.amzn1      @project               \nerlang-docbuilder.x86_64         R14B-04.2.7.amzn1      @project               \nerlang-edoc.x86_64               R14B-04.2.7.amzn1      @project               \nerlang-erl_docgen.x86_64         R14B-04.2.7.amzn1      @project               \nerlang-erl_interface.x86_64      R14B-04.2.7.amzn1      @project               \nerlang-erts.x86_64               R14B-04.2.7.amzn1      @project               \nerlang-et.x86_64                 R14B-04.2.7.amzn1      @project               \nerlang-eunit.x86_64              R14B-04.2.7.amzn1      @project               \nerlang-examples.x86_64           R14B-04.2.7.amzn1      @project               \nerlang-gs.x86_64                 R14B-04.2.7.amzn1      @project               \nerlang-hipe.x86_64               R14B-04.2.7.amzn1      @project               \nerlang-ic.x86_64                 R14B-04.2.7.amzn1      @project               \nerlang-inets.x86_64              R14B-04.2.7.amzn1      @project               \nerlang-inviso.x86_64             R14B-04.2.7.amzn1      @project               \nerlang-jinterface.x86_64         R14B-04.2.7.amzn1      @project               \nerlang-kernel.x86_64             R14B-04.2.7.amzn1      @project               \nerlang-megaco.x86_64             R14B-04.2.7.amzn1      @project               \nerlang-mnesia.x86_64             R14B-04.2.7.amzn1      @project               \nerlang-observer.x86_64           R14B-04.2.7.amzn1      @project               \nerlang-odbc.x86_64               R14B-04.2.7.amzn1      @project               \nerlang-orber.x86_64              R14B-04.2.7.amzn1      @project               \nerlang-os_mon.x86_64             R14B-04.2.7.amzn1      @project               \nerlang-otp_mibs.x86_64           R14B-04.2.7.amzn1      @project               \nerlang-parsetools.x86_64         R14B-04.2.7.amzn1      @project               \nerlang-percept.x86_64            R14B-04.2.7.amzn1      @project               \nerlang-pman.x86_64               R14B-04.2.7.amzn1      @project               \nerlang-public_key.x86_64         R14B-04.2.7.amzn1      @project               \nerlang-reltool.x86_64            R14B-04.2.7.amzn1      @project               \nerlang-runtime_tools.x86_64      R14B-04.2.7.amzn1      @project               \nerlang-sasl.x86_64               R14B-04.2.7.amzn1      @project               \nerlang-snmp.x86_64               R14B-04.2.7.amzn1      @project               \nerlang-ssh.x86_64                R14B-04.2.7.amzn1      @project               \nerlang-ssl.x86_64                R14B-04.2.7.amzn1      @project               \nerlang-stdlib.x86_64             R14B-04.2.7.amzn1      @project               \nerlang-syntax_tools.x86_64       R14B-04.2.7.amzn1      @project               \nerlang-test_server.x86_64        R14B-04.2.7.amzn1      @project               \nerlang-toolbar.x86_64            R14B-04.2.7.amzn1      @project               \nerlang-tools.x86_64              R14B-04.2.7.amzn1      @project               \nerlang-tv.x86_64                 R14B-04.2.7.amzn1      @project               \nerlang-typer.x86_64              R14B-04.2.7.amzn1      @project               \nerlang-webtool.x86_64            R14B-04.2.7.amzn1      @project               \nerlang-xmerl.x86_64              R14B-04.2.7.amzn1      @project               \ngeneric-logos.noarch             17.0.0-2.5.amzn1       @project               \nhttpd24.x86_64                   2.4.4-2.45.amzn1       @project               \nhttpd24-tools.x86_64             2.4.4-2.45.amzn1       @project               \njava-1.7.0-oracle.x86_64         1.7.0.17-2.0.cf        @project               \njava-1.7.0-oracle-devel.x86_64   1.7.0.17-2.0.cf        @project               \njava-1.7.0-oracle-jdbc.x86_64    1.7.0.17-2.0.cf        @project               \nmongo-10gen.x86_64               2.4.2-mongodb_1        @project               \nmongo-10gen-server.x86_64        2.4.2-mongodb_1        @project               \nopenssl.x86_64                   1:1.0.1e-4.53.amzn1    @project               \n                                 11.2.0.3.0-1           @project               \n                                 11.2.0.3.0-1           @project               \nrabbitmq-server.noarch           3.0.4-1                @project               \nproject-backend.noarch          1.0.0-155              @project               \nproject-schema.noarch           1.0.0-115              @project               \nproject-webapp.noarch           2.0.0-333              @project               \ntomcat7.noarch                   7.0.37-1.24.amzn1      @project               \ntomcat7-el-2.2-api.noarch        7.0.37-1.24.amzn1      @project               \ntomcat7-jsp-2.2-api.noarch       7.0.37-1.24.amzn1      @project               \ntomcat7-lib.noarch               7.0.37-1.24.amzn1      @project               \ntomcat7-servlet-3.0-api.noarch   7.0.37-1.24.amzn1      @project               \n'
    test.ok results, 'Extract data object should be available.'
    test.equal results.length, 82, 'List of elements is incorect.'
    test.equal (result for result in results when result.name is 'project-webapp').length, 1, 'The element project-webapp should be available.'
    test.done()

  testInvalidSingleLine: (test) ->
    test.expect 1
    result = RpmUtil.resolveDataByLine '                                     11.2.0.3.0-1                  @project'
    test.equal result, undefined, 'Result should be null'
    test.done()
